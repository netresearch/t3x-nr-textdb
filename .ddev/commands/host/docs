#!/bin/bash

## Description: Render TYPO3 extension documentation
## Usage: docs
## Example: ddev docs

set -e

echo "ğŸ“š Rendering TYPO3 Extension Documentation"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

# Check if Documentation directory exists
if [ ! -d "Documentation" ]; then
    echo "âŒ Error: Documentation/ directory not found"
    echo "   Please create a Documentation/ directory with Index.rst"
    exit 1
fi

# Check if Documentation/Index.rst exists
if [ ! -f "Documentation/Index.rst" ]; then
    echo "âŒ Error: Documentation/Index.rst not found"
    echo "   Please create Documentation/Index.rst as the entry point"
    exit 1
fi

echo "ğŸ“– Source:  Documentation/"
echo "ğŸ“¦ Output:  Documentation-GENERATED-temp/"
echo ""
echo "ğŸ”¨ Rendering documentation with TYPO3 render-guides..."
echo ""

# Render documentation using TYPO3 render-guides Docker image
docker run --rm --pull always \
    -v "$(pwd)/Documentation:/project/Documentation" \
    -v "$(pwd)/Documentation-GENERATED-temp:/project/Documentation-GENERATED-temp" \
    ghcr.io/typo3-documentation/render-guides:latest --config=Documentation

echo ""
echo "âœ… Documentation rendered successfully!"
echo ""
echo "ğŸŒ View at: https://docs.nr-textdb.ddev.site/"
echo ""
